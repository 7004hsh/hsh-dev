---
title: N-Queen 백트래킹
layout: post
date: 2025-03-28 00:00:00 +0900
categories: [알고리즘, 백트래킹]
tags: [Python, N-Queen]
---

이 글은 **N-Queen 문제**를 백트래킹으로 해결한 내용을 담고 있습니다.

`N x N` 체스판 위에 서로 공격하지 않도록 **N개의 퀸**을 배치하는 모든 경우의 수를 구하는 문제입니다.

---

## 📌 핵심 아이디어

- 체스판을 2차원 배열로 구성하여 퀸의 위치를 저장합니다.
- 백트래킹으로 한 줄씩 퀸을 배치해 나가며,
- 같은 열/왼쪽 위 대각선/오른쪽 위 대각선에 퀸이 있는지 검사합니다.
- 모든 퀸을 배치했을 경우 정답 카운트를 증가시킵니다.

---

## 🧩 코드 설명

```python
N = int(input())  # 퀸 개수 입력
list_list = [[0 for _ in range(N)] for _ in range(N)]  # N x N 체스판 초기화
a = 0  # 가능한 퀸 배치의 수를 저장할 변수
```

`list_list`는 퀸의 위치를 저장하는 체스판입니다.
변수 `a`는 올바른 배치가 나올 때마다 1씩 증가합니다.

---

## 🧠 백트래킹 함수 정의

```python
def queenqueen(x, num):
    global a
```

- `x`: 현재 퀸을 놓을 행(row)
- `num`: 남은 퀸 개수

---

## ✅ 종료 조건

```python
    if num == 0:
        a += 1
```

모든 퀸을 놓았다면 가능한 배치로 판단하고 카운트를 증가시킵니다.

---

## ✅ 첫 줄은 검사 없이 배치

```python
    elif N == num:
        for i in range(N):
            list_list[x][i] = 1
            queenqueen(x + 1, num - 1)
            list_list[x][i] = 0
```

가장 첫 번째 줄은 아직 퀸이 없기 때문에, 모든 열에 대해 퀸을 시도해 볼 수 있습니다.
재귀가 끝나면 백트래킹을 위해 다시 퀸을 제거합니다.

---

## ✅ 나머지 줄은 유효성 검사 필요

```python
    elif N > num > 0 and N > x >= 1:
        for j in range(N):
            valid = True
            for i in range(x):
                if list_list[i][j] == 1:  # 같은 열 검사
                    valid = False
                    break
                if j - (x - i) >= 0 and list_list[i][j - (x - i)] == 1:  # 왼쪽 대각선 검사
                    valid = False
                    break
                if j + (x - i) < N and list_list[i][j + (x - i)] == 1:  # 오른쪽 대각선 검사
                    valid = False
                    break
```

이전에 놓인 퀸들과의 충돌 여부(열/대각선)를 검사하여 유효한 위치인지 판단합니다.

---

## ✅ 퀸을 놓고 재귀 호출 → 백트래킹

```python
            if valid:
                list_list[x][j] = 1
                queenqueen(x + 1, num - 1)
                list_list[x][j] = 0
```

유효한 위치라면 퀸을 놓고 다음 행으로 재귀적으로 탐색하며,
탐색이 끝난 후에는 원상복구(백트래킹)를 합니다.

---

## ✅ 실행 및 출력

```python
queenqueen(0, N)
print(a)
```

처음 행부터 시작하여 가능한 퀸 배치 수를 출력합니다.

---

## 🏁 예시 입력/출력

```
입력: 8
출력: 92
```

---

## ⚠️ 참고

> 하지만 이 코드를 그대로 쓰시면 **시간 초과**가 날 수도 있어요!  
> 시간 복잡도가 `O(N²)`이라 `N`이 12 이상이면 실행 시간이 급격히 증가합니다.  
> 👉 그래서 **최적화**도 함께 고려해보는 것이 좋습니다 🔧

---

앞으로는 set과 1차원 배열을 활용한 최적화 버전도 시도해보려 합니다 😄
